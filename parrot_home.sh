#!/bin/bash

name=$(logname)
sudo echo ""
echo "This script needs a bit of user interaction sometimes"
echo "Press enter to start the script"
read 

echo "Download List files for gobuster/hashcat/LFI/etc. ? (Y/N)"
read download_lists

# Deleting desktop Icons
cd /home/$name/Desktop
rm anon-gui.desktop codium.desktop encryptpad.desktop libreoffice-startcenter.desktop torbrowser.desktop
rm parrot-zulucrypt.desktop parrot-sirikali.desktop password.txt README.license

mkdir /home/$name/Shells


# apt-get

sudo wget -qO - https://download.sublimetext.com/sublimehq-pub.gpg | sudo apt-key add -
sudo echo "deb https://download.sublimetext.com/ apt/stable/" | sudo tee /etc/apt/sources.list.d/sublime-text.list

arr=("gem" "nmap" "hashcat" "terminator" "wireshark" "gobuster" "dirbuster" "git" 
	"strace" "ltrace" "radare2" "radare2-cutter" "smbmap" "exploitdb" "mingw-w64" "vim"
	"tcpdump" "burpsuite" "python3-pip" "apt-transport-https" "sublime-text" "metasploit-framework"
    "smbclient" "nfs-common" "hydra" "hydra-gtk" "wpscan" "freerdp2-x11" "rlwrap" "hexedit"
    "sqlitebrowser" "spike" "libssl-dev" "enum4linux" "ftp" "sqlmap" "sshuttle" "socat" "exploitdb-papers"
    "passing-the-hash" "davtest" "snmp" "snmpcheck" "ike-scan" "neo4j" "bloodhound" "cifs-utils" "snmp-mibs-downloader"
    "crackmapexec") 

sudo apt update -y && sudo apt upgrade -y && sudo apt autoremove -y


for i in "${arr[@]}"; do
	sudo apt install $i -y  2>>~/error.log
done

sudo gem install evil-winrm
echo Installed evil-winrm

#Pip for python 2.x
curl https://bootstrap.pypa.io/pip/2.7/get-pip.py --output get-pip.py
sudo python2 get-pip.py
rm get-pip.py


# Installing pip modules

p2_modules=("requests" "six" "impacket" "droopescan")

python3 -m pip install pyldap

for i in "${p2_modules[@]}"; do
    python2 -m pip install $i 2>>~/error.log
done


# Github and 3rd party software stuff
cd /opt

git clone https://github.com/ropnop/kerbrute.git
cd kerbrute
make linux

git clone https://github.com/danielmiessler/SecLists.git


wget https://gitlab.com/kalilinux/packages/hash-identifier/-/raw/kali/master/hash-id.py

git clone https://github.com/xmendez/wfuzz.git

git clone https://github.com/openwall/john -b bleeding-jumbo john   # Better JohnTheRipper Version
cd john/src/
./configure
make -s clean && make -sj4
cd ../..

git clone https://github.com/SecureAuthCorp/impacket.git
pip3 install impacket/ 2>>~/error.log

git clone https://github.com/helviojunior/MS17-010.git
git clone https://github.com/samratashok/nishang.git
git clone https://github.com/rasta-mouse/Sherlock.git # Checking for windows exploits
git clone https://github.com/ropnop/windapsearch.git

mkdir PrintSpoofer && cd PrintSpoofer
wget https://github.com/itm4n/PrintSpoofer/releases/download/v1.0/PrintSpoofer64.exe -O PrintSpoofer64.exe
wget https://github.com/itm4n/PrintSpoofer/releases/download/v1.0/PrintSpoofer32.exe -O PrintSpoofer32.exe
cd ..


# Lists

if [[ $download_lists == 'Y' || $download_lists == 'y' ]]; then

    mkdir /home/$name/Lists 
    mkdir /home/$name/Lists/LFI 
    mkdir /home/$name/Lists/web 
    mkdir /home/$name/Lists/Wordlists 

    cd /home/$name/Lists/LFI
    wget https://raw.githubusercontent.com/danielmiessler/SecLists/master/Fuzzing/LFI/LFI-gracefulsecurity-windows.txt -O LFI-Windows.txt
    wget https://raw.githubusercontent.com/danielmiessler/SecLists/master/Fuzzing/LFI/LFI-gracefulsecurity-linux.txt -O LFI-Linux.txt
    wget https://raw.githubusercontent.com/danielmiessler/SecLists/master/Fuzzing/LFI/LFI-LFISuite-pathtotest.txt -O LFI-Linux-Paths.txt
    wget https://raw.githubusercontent.com/danielmiessler/SecLists/master/Fuzzing/LFI/LFI-LFISuite-pathtotest-huge.txt -O LFI-Linux-Paths-Huge.txt
    wget https://raw.githubusercontent.com/danielmiessler/SecLists/master/Fuzzing/LFI/LFI-Jhaddix.txt -O LFI-Jhaddix.txt

    cd /home/$name/Lists/web
    wget https://raw.githubusercontent.com/nop-tech/Pentesting/main/wordlists/gobuster/Gobuster-Dir-Small.txt -O Gobuster-Dir-Small.txt
    wget https://raw.githubusercontent.com/nop-tech/Pentesting/main/wordlists/gobuster/Gobuster-Dir-Medium.txt -O Gobuster-Dir-Medium.txt
    wget https://raw.githubusercontent.com/nop-tech/Pentesting/main/wordlists/gobuster/Gobuster-Dir-Big.txt -O Gobuster-Dir-Big.txt
    wget https://raw.githubusercontent.com/nop-tech/Pentesting/main/wordlists/gobuster/Gobuster-Apache-User-Enum.txt -O Gobuster-Apache-User-Enum.txt
    wget https://raw.githubusercontent.com/nop-tech/Pentesting/main/wordlists/gobuster/directory_big_kali_version.txt -O kali_big.txt
    wget https://raw.githubusercontent.com/v0re/dirb/master/wordlists/common.txt -O dirb.txt
    wget https://raw.githubusercontent.com/v0re/dirb/master/wordlists/big.txt -O dirb_big.txt


    cd /home/$name/Lists/Wordlists
    wget https://download.weakpass.com/wordlists/90/rockyou.txt.gz
    gzip -d rockyou.txt.gz

fi

# Shells
cd /home/$name/Shells
wget https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php -O php-shell-pentestmonkey.php



# Fixing permissions

sudo chown -R user:user /home/$name/*

# Aliases

echo "alias kerbrute='/opt/kerbrute/dist/kerbrute_linux_amd64'" >> ~/.bash_aliases
echo "alias pattern_create='/usr/share/metasploit-framework/tools/exploit/pattern_create.rb'" >> ~/.bash_aliases
echo "alias pattern_offset='/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb'" >> ~/.bash_aliases
echo "alias web='sudo python3 -m http.server 80'" >> ~/.bash_aliases

source ~/.bashrc
